<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style type="text/css">
        #app {
            text-align: center;
        }
    </style>
    <script th:src="@{/static/js/jQuery.js}"></script>
</head>
<body>
<div id="app">
    <fieldset>
        <legend><h1>SSO-单点登陆</h1></legend>
        <form action="#" th:action="@{/login}" th:object="${userInfo}" method="post">
            <input id="username" name="username" type="text" th:field="*{username}" placeholder="请输出用户名"/>
            <br>
            <br>
            <input id="password" name="password" type="password" th:field="*{password}" placeholder="请输入密码">
            <br>
            <br>
            <button onclick="login()">登陆</button>
        </form>
    </fieldset>
</div>
</body>
<script type="application/javascript">

    let orginUrl = '';

    window.onload = function () {
        var url = window.location.href
        var pattern = new RegExp('orginUrl=[a-zA-z]+://[^\\s]*', 'i')
        var orgin = pattern.exec(url)[0];
        orginUrl = orgin.substr(orgin.indexOf('=') + 1, orgin.length)
        console.log(orginUrl)
    }


    function login() {

        let username = $('#username').getAttribute('value');
        let password = $('#password').getAttribute('value');

        console.log(username, password)

        $.ajax({
            url: 'http://server.sso.demo:8500/login?orginUrl=' + orginUrl,
            type: 'POST',
            contentType: 'application/json;charset=utf-8',
            data: JSON.stringify({'username': username, 'password': password}),
            dataType: 'text',
            success: function (result) {

            },
            error: function (msg) {

            }
        })
    }

</script>
</html>