<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style type="text/css">
        #app {
            text-align: center;
        }
    </style>
    <script th:src="@{/static/js/jQuery.js}"></script>
</head>
<body>
<div id="app">
    <fieldset>
        <legend><h1>SSO-单点登陆</h1></legend>
        <form th:action="@{/login}" th:object="${loginParam}" method="post">
            <input id="username" name="username" type="text" th:field="*{username}" placeholder="请输出用户名"/>
            <br>
            <br>
            <input id="password" name="password" type="password" th:field="*{password}" placeholder="请输入密码"/>
            <br>
            <br>
            <input id="originUrl" name="originUrl" hidden th:field="*{originUrl}" placeholder="请输入密码"/>
            <p th:if="*{msg}" th:text="*{msg}" style="color: red;"></p>
            <button type="button" onclick="login()">登陆</button>
        </form>
    </fieldset>
</div>
</body>
<script type="application/javascript">

    let originUrl = '';

    window.onload = function () {
        const url = window.location.href;
        const pattern = new RegExp('originUrl=[a-zA-z]+://[^\\s]*', 'i');
        const origin = pattern.exec(url)[0];
        originUrl = origin.substr(origin.indexOf('=') + 1, origin.length)
    }

    function login() {

        let username = $('#username').val();
        let password = $('#password').val();

        console.log(username, password)

        $.ajax({
            url: '/login',
            type: 'POST',
            contentType: 'application/json;charset=utf-8',
            param: {"originUrl": originUrl},
            data: JSON.stringify({'username': username, 'password': password}),
            dataType: 'text',
            success: function (result) {

            },
            error: function (msg) {

            }
        })
    }

</script>
</html>